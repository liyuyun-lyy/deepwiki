openapi: 3.0.3
info:
  title: Deepwiki Image Support
  version: 0.1.0
paths:
  /docs/generate:
    post:
      summary: Generate documentation with local image support
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GenerateRequest'
      responses:
        '200':
          description: Generation completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenerateResponse'
  /docs/generations/{generationId}/missing-images:
    get:
      summary: List missing or blocked image assets for a generation
      parameters:
        - name: generationId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Missing or blocked image assets
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MissingImagesResponse'
components:
  schemas:
    GenerateRequest:
      type: object
      required:
        - sourceRoot
        - outputRoot
      properties:
        sourceRoot:
          type: string
          description: Project root containing documentation sources and images
        outputRoot:
          type: string
          description: Output directory for generated documentation
        includeImages:
          type: boolean
          description: Whether to include local image assets in output
          default: true
    GenerateResponse:
      type: object
      required:
        - generationId
        - missingImageCount
      properties:
        generationId:
          type: string
        missingImageCount:
          type: integer
          minimum: 0
    MissingImagesResponse:
      type: object
      required:
        - items
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ImageAssetReport'
    ImageAssetReport:
      type: object
      required:
        - sourcePage
        - imagePath
        - status
      properties:
        sourcePage:
          type: string
        imagePath:
          type: string
        status:
          type: string
          enum: [missing, blocked]
        reason:
          type: string
